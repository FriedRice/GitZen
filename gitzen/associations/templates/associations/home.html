<html>
<head>
<style type="text/css">
    table, td, th {
        border:1px solid black;
    }
    table.noborder, td.noborder, th.noborder {
        border:0px;
    }
    td {
        padding:5px;
    }
    a:link, a:visited {
        text-decoration:none;
        color:blue;
    }
    h1, h2, h3{
        text-align:center;
    }
</style>
<title>Home</title>
</head>

<body>
<h1>GitZen</h1>
<h3><a href="/change/">Change Account Data</a></h3>
<br/>

<h2>Associations</h2>
{% if c_assocs != 'broken' %}
    <h3>Closed Associations</h3>
    {% if c_assocs %}
        <table align="center" style="width:75%">
        <tr>
        <th>Association</th>
        <th>Zendesk User</th>
        <th>Last Zen Ticket Update</th>
        <th>GitHub User</th>
        <th>Git Issue Labels</th>
        <th>Git Status</th>
        </tr>
        {% for a in c_assocs %}
            <tr>
            <td align="center"><a href="/zen/{{ a.znum }}/">Z{{ a.znum }}</a> --&gt; 
            <a href="/git/{{ a.gnum }}/">G{{ a.gnum }}</a></td>
            <td align="center">{{ a.zuser }}</td>
            <td align="center">{{ a.zdate }}</td>
            <td align="center">{{ a.guser }}</td>
            <td align="center">
            {% if a.glabels %}
                {% for b in a.glabels %}
                    {{ b }},
                {% endfor %}
            {% else %}
                None
            {% endif %}
            </td>
            <td align="center">
                <span style="color:red">Closed ({{ a.gdate }})</span>
            </td>
        {% endfor %}
        </table>
    {% else %}
        <p align="center">There are currently no Associations ready to be closed.</p>
    {% endif %}
    <br/>

    <h3>Open Associations</h3>
    {% if o_assocs %}
        <table align="center" style="width:75%">
        <tr>
        <th>Association</th>
        <th>Zendesk User</th>
        <th>Last Zen Ticket Update</th>
        <th>GitHub User</th>
        <th>Git Issue Labels</th>
        <th>Git Status</th>
        </tr>
        {% for a in o_assocs %}
            <tr>
            <td align="center"><a href="/zen/{{ a.znum }}/">Z{{ a.znum }}</a> --&gt; 
            <a href="/git/{{ a.gnum }}/">G{{ a.gnum }}</a></td>
            <td align="center">{{ a.zuser }}</td>
            <td align="center">{{ a.zdate }}</td>
            <td align="center">{{ a.guser }}</td>
            <td align="center">
            {% if a.glabels %}
                {% for b in a.glabels %}
                    {{ b }},
                {% endfor %}
            {% else %}
                None
            {% endif %}
            </td>
            <td align="center"> 
                <span style="color:green">Open ({{ a.gdate }})</span>
            </td>
            </tr>
        {% endfor %}
        </table>
    {% else %}
        <p align="center">There are currently no open Associations.</p>
    {% endif %}
    <br/>

    <h3>Not Associated with GitHub</h3>
    {% if no_assocs %}
        <table align="center" style="width:50%">
        <tr>
        <th>Zendesk Ticket</th>
        <th>Zendesk User</th>
        <th>Last Updated</th>
        <th>Displayed Association</th>
        </tr>
        {% for a in no_assocs %}
            <tr>
            <td align="center"><a href="/zen/{{ a.znum }}/">Z{{ a.znum }}</a></td>
            <td align="center">{{ a.zuser }}</td>
            <td align="center">{{ a.zdate }}</td>
            <td align="center">{{ a.dassoc }}</td>
            </tr>
        {% endfor %}
        </table>
    {% else %}
        <p align="center">There are currently no Zendesk Tickets without Git
        Associations.</p>
    {% endif %}
{% else %}
    <p align="center">There was an Error connecting to either GitHub or
    Zendesk. Try adjusting your account settings.</p>
{% endif %}

<br/><br/>

<table class="noborder" style="width:100%;">
<tr><td class="noborder" colspan="3">
<h2>GitHub and Zendesk Info</h2>
</td></tr>

<tr>
<td class="noborder">
    <table>
    <tr>
    <th>Open GitHub Tickets</th>
    </tr>

    {% if gitTics %}
        {% if gitTics != 'broken' %}
            {% for i in gitTics %}
                <tr><td><a href='/git/{{ i.number }}/'>{{ i.number }}.</a> 
                {{ i.title }}</td></tr>
            {% endfor %}
        {% else %}
            <tr><td align="center">There was an Error connecting to GitHub. Try 
            adjusting your account settings.</td></tr>
        {% endif %}
    {% else %}
        <tr><td align="center">There are currently no open GitHub 
        Tickets.</td></tr>
    {% endif %}
    </table>
</td>

<td class="noborder">
    <table>
    <tr>
    <th colspan="2">Zendesk Tickets</th>
    </tr>
    <tr>
    <th>Subject</th>
    <th>Requester</th>
    </tr>

    {% if zenTics %}
        {% if zenTics != 'broken' %}
            {% for t in zenTics %}
                <tr>
                <td><a href="/zen/t{{ t.id }}/">{{ t.id }}.</a> 
                {{ t.subject }}</td>
                <td>{{ t.req_name }}</td>
                </tr>
            {% endfor %}
        {% else %}
            <tr><td align="center" colspan="2">There was an Error connecting 
            to Zendesk. Try adjusting your account settings.</td></tr>
        {% endif %}
    {% else %}
        <tr><td align="center" colspan="2">There are currently no Zendesk
        Tickets.</td></tr>
    {% endif %}
    </table>
</td>

<td class="noborder">
    <table>
    <tr>
    <th colspan="3">Zendesk Users</th>
    </tr>
    <tr>
    <th>Name</th>
    <th>Email</th>
    <th>Organization</th>
    </tr>

    {% if zenUsers %}
        {% if zenUsers != 'broken' %}
            {% for u in zenUsers %}
                <tr>
                <td align="center"><a href="/zen/u{{ u.id }}/"
                >{{ u.name }}</a></td>
                <td>{{ u.email }}</td>
                <td>{{ u.org_name }}</td>
                </tr>
            {% endfor %}
        {% else %}
            <tr><td align="center" colspan="3">There was an Error connecting 
            to Zendesk. Try adjusting your account settings.</td></tr>
        {% endif %}
    {% else %}
        <tr><td align="center" colspan="3">There are currently no Zendesk 
        users.</td></tr>
    {% endif %}
    </table>
</td>
</tr>
</table>

</body>
</html>
