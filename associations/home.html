<html>
<head>
<style type="text/css">
table, td, th {
border:1px solid black;
}
table.noborder, td.noborder, th.noborder {
border:0px;
}
td {
padding:5px;
}
a:link, a:visited {
text-decoration:none;
color:blue;
}

</style>
</head>

<body>
<table class="noborder" style="width:100%;">
<tr><th class="noborder" colspan="3"><h1>GitZen</h1></th></tr>
<tr>
<td class="noborder">
    <table>
    <tr>
    <th>Open GitHub Tickets</th>
    </tr>

    {% if gitTic %}
        {% for i in gitTic %}
            <tr><td><a href='/as/git/{{ i.number }}/'>{{ i.number }}.</a> 
            {{ i.title }}</td></tr>
        {% endfor %}
    {% else %}
        <tr><td>There are currently no open GitHub Tickets.</td></tr>
    {% endif %}
    </table>
</td>

<td class="noborder">
    <table>
    <tr>
    <th colspan="2">Zendesk Tickets</th>
    </tr>
    <tr>
    <th>Subject</th>
    <th>Requester</th>
    </tr>

    {% if zenTics %}
        {% for t in zenTics %}
            <tr>
            <td><a href="/as/zen/t{{ t.id }}/">{{ t.id }}.</a> 
            {{ t.subject }}</td>
            <td>{{ t.req_name }}</td>
            </tr>
        {% endfor %}
    {% else %}
        <tr><td>There are currently no Zendesk Tickets.</td></tr>
    {% endif %}
    </table>
</td>

<td class="noborder">
    <table>
    <tr>
    <th colspan="3">Zendesk Users</th>
    </tr>
    <tr>
    <th>Name</th>
    <th>Email</th>
    <th>Organization</th>
    </tr>

    {% if zenUsers %}
        {% for u in zenUsers %}
            <tr>
            <td align="center"><a href="/as/zen/u{{ u.id }}/"
            >{{ u.name }}</a></td>
            <td>{{ u.email }}</td>
            <td>{{ u.org_name }}</td>
            </tr>
        {% endfor %}
    {% else %}
        <tr><td>There are currently no Zendesk users.</td></tr>
    {% endif %}
    </table>
</td>
</tr>
</table>

<br/><br/>

<table class="noborder" style="width:100%">
<tr>
<th class="noborder"><h2>Close Associations</h2></th>
<th class="noborder"><h2>Add User to Issue</h2></th>
</tr>

<tr>
<td align="center">
<form action"/as/" method="post">{% csrf_token %}
    {{ cform.non_field_errors }}
    <p>Close Format: (ZUser1|ZTicket1) (ZUser2|ZTicket2)</p>
    <p>Close Query:</p>
    <div class="fieldWrapper">
        {{ cform.query.errors }}
        <label for="id_query"></label>
        {{ cform.query }}
    </div>
    <p><input name="close" type="submit" value="Close" /></p>
</form>
</td>

<td align="center">
    <form action="/as/" method="post">{% csrf_token %}
    {{ aform.non_field_errors }}
    <div class="fieldWrapper">
        {{ aform.gnum.errors }}
        <label for="id_gnum">GitHub Issue Ticket Number:</label>
        {{ aform.gnum }}
    </div>
    <div class="fieldWrapper">
        {{ aform.zuser.errors }}
        <label for="id_zuser">Zendesk User:</label>
        {{ aform.zuser }}
    </div>
    <p>Subject:</p>
    <div class="fieldWrapper">
        {{ aform.subject.errors }}
        <label for="id_subject"></label>
        {{ aform.subject }}
    </div>
    <p>Description:</p>
    <div class="fieldWrapper">
        {{ aform.desc.errors }}
        <label for="id_desc"></label>
        {{ aform.desc }}
    </div>
    <p><input name="add" type="submit" value="Add" /></p>
</form>

</td>
</tr>
</table>

<br/>

<h2 align="center">Associations</h2>
<h3 align="center">Closed Associations</h3>
{% if c_assocs %}
    <table align="center" style="width:75%">
    <tr>
    <th>Association</th>
    <th>Zendesk User</th>
    <th>Last Zen Ticket Update</th>
    <th>GitHub User</th>
    <th>Git Issue Labels</th>
    <th>Git Status</th>
    </tr>
    {% for a in c_assocs %}
        <tr>
        <td align="center"><a href="/as/zen/{{ a.zen }}/">Z{{ a.znum }}</a> --&gt; 
        <a href="/as/git/{{ a.git }}/">G{{ a.gnum }}</a></td>
        <td align="center">{{ a.zuser }}</td>
        <td align="center">{{ a.zdate }}</td>
        <td align="center">{{ a.guser }}</td>
        <td align="center">
        {% if a.glabels %}
            {% for b in a.glabels %}
                {{ b }},
            {% endfor %}
        {% else %}
            None
        {% endif %}
        </td>
        <td align="center">
            <span style="color:red">Closed ({{ a.gdate }})</span>
        </td>
        </tr>
    {% endfor %}
    </table>
{% else %}
    <p align="center">There are currently no Associations ready to be closed.</p>
{% endif %}
<br/>

<h3 align="center">Open Associations</h3>
{% if o_assocs %}
    <table align="center" style="width:75%">
    <tr>
    <th>Association</th>
    <th>Zendesk User</th>
    <th>Last Zen Ticket Update</th>
    <th>GitHub User</th>
    <th>Git Issue Labels</th>
    <th>Git Status</th>
    </tr>
    {% for a in o_assocs %}
        <tr>
        <td align="center"><a href="/as/zen/{{ a.zen }}/">Z{{ a.znum }}</a> --&gt; 
        <a href="/as/git/{{ a.git }}/">G{{ a.gnum }}</a></td>
        <td align="center">{{ a.zuser }}</td>
        <td align="center">{{ a.zdate }}</td>
        <td align="center">{{ a.guser }}</td>
        <td align="center">
        {% if a.glabels %}
            {% for b in a.glabels %}
                {{ b }},
            {% endfor %}
        {% else %}
            None
        {% endif %}
        </td>
        <td align="center"> 
            <span style="color:green">Open ({{ a.gdate }})</span>
        </td>
        </tr>
    {% endfor %}
    </table>
{% else %}
    <p align="center">There are currently no open Associations.</p>
{% endif %}
<br/>

<h3 align="center">Not Associated with GitHub</h3>
{% if no_assocs %}
    <table align="center" style="width:50%">
    <tr>
    <th>Zendesk Ticket</th>
    <th>Zendesk User</th>
    <th>Last Updated</th>
    <th>Displayed Association</th>
    </tr>
    {% for a in no_assocs %}
        <tr>
        <td align="center"><a href="/as/zen/{{ a.zen }}/">Z{{ a.znum }}</a></td>
        <td align="center">{{ a.zuser }}</td>
        <td align="center">{{ a.zdate }}</td>
        <td align="center">{{ a.dassoc }}</td>
        </tr>
    {% endfor %}
    </table>
{% else %}
    <p align="center">There are currently no Zendesk Tickets without Git
    Associations.</p>
{% endif %}
<br/>
</body>
</html>
